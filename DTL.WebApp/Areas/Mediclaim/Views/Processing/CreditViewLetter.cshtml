
@using DTL.Model.Models.Mediclaim
@model ClaimAndVoucherDetailModel
@{ ViewData["Title"] = "Cashless";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var claimtype = "";

}

<div class="container-fluid view_form">
    <input type="hidden" id="hdnempno" value="@Model.Cashless.SerialNo" />
    <input type="hidden" id="hdndesignation" value="@ViewBag.Designation" />
    <div class="row header_section mx-0 px-0">
        <div class="col-6 position-relative ps-0">
            <span class="btn btn-light float-start mt-1 me-2 d-block d-md-none" id="menu_toggle"><i class="fa-solid fa-bars"></i></span>
            <h3 class="mb-0">CreditLetter View</h3>
            @*<span class="subTitle">(To be filled by hospital only)</span>*@
        </div>
        <p class="mb-0 col-6 top_link_Section">
            <span class=""><a href="@Url.Action("Index","Home",new { Area="" })">Dashboard</a></span><span class="px-1">/</span><span><a href="@Url.Action("CashlessClaims","Processing",new { Area="Mediclaim" })">Cashless Credit Letter</a></span><span class="px-1">/</span><span>Credit Letter View</span>
        </p>
    </div>
    <div class="card border-card mt-0">
        <div class="card-body">
            <div class="position-relative">
                <div id="material-tabs">
                    @*<a id="tab1-tab" href="#tab1" class="active">Voucher Detail</a>*@
                    <a id="tab2-tab" href="#tab2">Raised Claim Application</a>

                    <span class="yellow-bar"></span>
                </div>
            </div>
            <div class="tab-content view_container_bg ">
                <div id="tab2">
                    <h4 class="form_title">
                        Detail Of Hospital
                    </h4>
                    <div class="row">
                        <div class="col-sm-12 col-md-6 col-lg-6 col-xl-6 mb-3 view_text_border">
                            <label class="form-label d-block mb-1" for="name">
                                Name Of Hospital
                            </label>
                            <p class="View_text">@Model.Cashless.NameOfHospital</p>
                        </div>
                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 mb-3 view_text_border">
                            <label class="form-label d-block mb-1">
                                Hospital Id
                            </label>
                            <p class="View_text">@Model.Cashless.HospitalId</p>
                        </div>
                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 mb-3 view_text_border">
                            <label class="form-label d-block mb-1">Phone Number</label>
                            <p class="View_text">@Model.Cashless.HospitalPhoneNumber</p>
                        </div>
                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 mb-3 view_text_border">
                            <label class="form-label d-block mb-1">Email Id</label>
                            <p class="View_text">@Model.Cashless.EmailId</p>
                        </div>
                        <div class="col-sm-12 col-md-9 col-lg-9 col-xl-9 mb-3 view_text_border">
                            <label class="form-label d-block mb-1">Address</label>
                            <p class="View_text">@Model.Cashless.HospitalAddress</p>
                        </div>
                    </div>

                    <h4 class="form_title mt-3 ">
                        General Details
                    </h4>
                    <div class="row">

                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3  mb-3 view_text_border">
                            <label class="form-label d-block mb-1">Credit Letter NO </label>
                            <p class="View_text">@Model.Cashless.SerialNo</p>
                        </div>

                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3  mb-3 view_text_border">
                            <label class="form-label d-block mb-1">Issue Date </label>
                            <p class="View_text">@Model.Cashless.IssueDate.ToString("dd-MM-yyyy")</p>
                        </div>

                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3  mb-3 view_text_border">
                            <label class="form-label d-block mb-1">Admission Date </label>
                            <p class="View_text">@Model.Cashless.DateOfAdmission.ToString("dd-MM-yyyy")</p>
                        </div>
                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3  mb-3 view_text_border">
                            <label class="form-label d-block mb-1">Case Type </label>
                            <p class="View_text">@Model.Cashless.CASE_TYPE</p>
                        </div>


                    </div>

                    <h4 class="form_title mt-3 shadow-2-strong">
                        Report Document Upload
                    </h4>
                    <div class="row">
                        <div class="col-sm-12">
                            <table id="example1" class="table table-bordered view_table">
                                <thead>
                                    <tr>
                                        <th width="7%" class="text-center">Sr. No.</th>
                                        <th>Document Type</th>
                                        <th>Attach file </th>

                                    </tr>
                                </thead>
                                <tbody>
                                    @if (Model.Cashless.Documents.Count() > 0)
                                    {

                                        var _index = 1;
                                        @foreach (var item in Model.Cashless.Documents)
                                        {
                                            <tr>
                                                <td>
                                                    @_index
                                                </td>
                                                <td>
                                                    @item.DocumentFor
                                                </td>
                                                <td class="text-center">
                                                    @*<a href="@item.DocumentPath" target="_blank">@item.FileName</a>*@
                                                    <a href="/@item.DocumentPath" class="pdfIcons" target="_blank"><i class="fa fa-file-pdf" aria-hidden="true"></i></a>
                                                </td>
                                            </tr>
                                            _index = _index + 1;
                                        }
                                    }
                                </tbody>
                            </table>

                        </div>
                    </div>
                    <h4 class="form_title mt-3 shadow-2-strong">
                        Extend Document Upload
                    </h4>
                    @*<div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 mb-3 view_text_border">
                            <label class="form-label d-block mb-1">Extended Of Stay</label>
                            <p class="View_text">@Model.approveReject.Extended_Stay</p>
                        </div>*@
                    <div class="row">

                        <div class="col-sm-12">
                            <table id="example1" class="table table-bordered view_table">
                                <thead>
                                    <tr>
                                        <th width="7%" class="text-center">Sr. No.</th>
                                        <th>Document Type</th>
                                        <th>Attach file </th>

                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var item in Model.approveReject.Documents)
                                    {
                                        var _index = 1;
                                        <tr>
                                            <td>
                                                @_index
                                            </td>

                                            <td>
                                                @item.DocumentFor
                                            </td>
                                            <td class="text-center">

                                                <a href="/@item.DocumentPath" class="pdfIcons" target="_blank"><i class="fa fa-file-pdf" aria-hidden="true"></i></a>
                                            </td>
                                        </tr>
                                        _index = _index + 1;
                                    }

                                </tbody>
                            </table>

                        </div>
                    </div>

                    <h4 class="form_title mt-3 shadow-2-strong">
                        Detail Of Patients
                    </h4>
                    <div class="row">

                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 mb-3view_text_border">
                            <label class="form-label d-block mb-1">PPO Number</label>
                            <p class="View_text">@Model.Cashless.PPONumber</p>
                        </div>

                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 mb-3 mb-3view_text_border">
                            <label class="form-label d-block mb-1">Pensioner Name</label>
                            <p class="View_text">@Model.Cashless.PensionerName</p>
                        </div>

                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3  mb-3 view_text_border">
                            <label class="form-label d-block mb-1" for="name">Name Of Patient</label>
                            <p class="View_text">@Model.Cashless.PatientName</p>
                        </div>

                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 mb-3 view_text_border">
                            <label class="form-label d-block mb-1">Relation Of Pensioner </label>
                            <p class="View_text">@Model.Cashless.Relation</p>
                        </div>

                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 mb-3 view_text_border">
                            <label class="form-label d-block mb-1">Employee Mobile No</label>
                            <p class="View_text">@Model.Cashless.EmployeeNo</p>
                        </div>

                        @*<div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 mb-3 view_text_border">
                                <label class="form-label d-block mb-1">Page No </label>
                                <p class="View_text">@Model.Cashless.PageNo</p>
                            </div>*@
                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 mb-3 view_text_border">
                            <label class="form-label d-block mb-1">Categoey Of Room </label>
                            <p class="View_text">@Model.Cashless.CategoryOfRoom</p>
                        </div>


                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 mb-3 view_text_border">
                            <label class="form-label d-block mb-1">Name Of Doctor</label>
                            <p class="View_text">@Model.Cashless.NameOfDoctor</p>
                        </div>

                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 mb-3 view_text_border">
                            <label class="form-label d-block mb-1">Doctor Mobile No</label>
                            <p class="View_text">@Model.Cashless.Doctor_NO</p>
                        </div>



                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 mb-3view_text_border">
                            <label class="form-label d-block mb-1">Petient Mobile Number</label>
                            <p class="View_text">@Model.Cashless.PatientNo</p>
                        </div>

                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 mb-3 view_text_border">
                            <label class="form-label d-block mb-1">Resident Address</label>
                            <p class="View_text">@Model.Cashless.ResidentAddress</p>
                        </div>

                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 mb-3 view_text_border">
                            <label class="form-label d-block mb-1">Provisional Diagnosis</label>
                            <p class="View_text">@Model.Cashless.ProvisionalDiagnosis</p>
                        </div>

                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 mb-3 view_text_border">
                            <label class="form-label d-block mb-1">Intended Tretment</label>
                            <p class="View_text">@Model.Cashless.IstendedTreatment</p>
                        </div>

                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 mb-3 view_text_border">
                            <label class="form-label d-block mb-1">Duration Of Stay</label>
                            <p class="View_text">@Model.Cashless.DurationOfStay</p>
                        </div>

                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 mb-3 view_text_border">
                            <label class="form-label d-block mb-1">Extended Of Stay</label>
                            <p class="View_text">@Model.approveReject.Extended_Stay</p>
                        </div>

                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 mb-3 view_text_border">
                            <label class="form-label d-block mb-1">Organization Name</label>
                            <p class="View_text">@Model.Cashless.Organization</p>
                        </div>



                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 mb-3 view_text_border">
                            <label class="form-label d-block mb-1">Duration Of Extended Date</label>
                            <input class="form-check-input" type="checkbox" id="chk_Extended">
                            <p>(In case of stay beyond this period,hospial shall intimate with justification for extended stay)</p>

                        </div>
                    </div>

                    <h4 class="form_title mt-1 shadow-2-strong" id="exedend_heder" style="display: none">
                        Extended Date
                    </h4>
                    <div class="row" id="Extednded_duration" style="display: none">
                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 col-md-5 mb-3">
                            <label class="form-label d-block mb-1">Extended Date </label>
                            <input type="text" id="txtexteded_date" maxlength="10" class="form-control form-control-sm" placeholder="Extended Duration Time" onkeypress="return  isNumberKey(event)" />
                        </div>
                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 col-md-5 mb-3">
                            <label class="form-label d-block mb-1">
                                Document Type<span class="text-danger req_text">*</span>
                            </label>
                            <select id="selDocumentType" class="form-control">
                                <option value="0">Select</option>
                                <option value="1">Case Summary</option>
                            </select>

                        </div>
                        <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3 col-md-5 mb-3">
                            <label class="form-label d-block mb-1">
                                Choose file<span class="text-danger req_text">*</span>
                            </label>
                            <input class="form-control" type="file" id="fileUpload" accept="application/pdf">

                        </div>
                        <div class="col-sm-3 col-md-2 col-lg-2 col-xl-1 position-relative px-0">
                            <button type="button" class="btn btn-success position-absolute top-25" id="btnUpload"><i class="fa fa-plus mr-2"></i>Add</button>
                        </div>
                        <div class="col-sm-12">
                            <table id="tblDocument" class="table table-bordered table-hover">
                                <thead>
                                    <tr>
                                        <th style="width:10%">Sr. No.</th>
                                        <th style="width:40%">Document Type</th>
                                        <th style="width:30%">Attach File</th>
                                        <th style="width:20%">Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>

                        </div>
                    </div>

                    @*<h4 class="form_title mt-3 ">
                            Requested By Hospital at the time of discharge
                        </h4>*@
                    @*<div class="row">


                            <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3  mb-3 view_text_border">
                                <label class="form-label d-block mb-1"> Date Of Discharge </label>
                                <p class="View_text">@Model.Cashless.DateOfDischargeOrDeath.ToString("dd-MM-yyyy")</p>
                            </div>

                            <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3  mb-3 view_text_border">
                                <label class="form-label d-block mb-1">Diagnosis</label>
                                <p class="View_text">@Model.Cashless.Diagnosis</p>
                            </div>
                            <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3  mb-3 view_text_border">
                                <label class="form-label d-block mb-1">Type Of Tretment</label>
                                <p class="View_text">@Model.Cashless.Treatment</p>
                            </div>

                            <div class="col-sm-6 col-md-6 col-lg-4 col-xl-3  mb-3 view_text_border">
                                <label class="form-label d-block mb-1">Signature Of Discharge Time</label>
                                <p class="View_text">@Model.Cashless.SignatureDischargeTime</p>
                            </div>

                        </div>*@



                    <div class="border-card border-top-0 ">
                        <h4 class="form_title shadow-2-strong">
                            CMO (Cheif Medical Officer)
                        </h4>
                        <div class="row">
                            @if (ViewBag.Designation.ToLower() == "cmo")
                            {
                                <div class="col-sm-6 col-md-6 col-lg-6 col-xl-6 ">
                                    <label class="form-label d-block mb-1">CMO Remark<span class="text-danger req_text">*</span></label>
                                    <textarea type="text" id="txtCMORemark" class="form-control form-control-sm">@Model.Cashless.ApproveRemark</textarea>
                                </div> }
                            else
                            {
                                <div class="col-sm-6 col-md-6 col-lg-6 col-xl-6 ">
                                    <label class="form-label d-block mb-1">CMO Remark<span class="text-danger req_text">*</span></label>
                                    <textarea type="text" id="txtCMORemark" class="form-control form-control-sm" readonly disabled>@Model.Cashless.CMORemark</textarea>
                                </div>}
                        </div>

                        <div class="row mt-4">
                            <div class="col-lg-12" style="float:right">
                                <button id="btnModalApprove" type="button" class="btn btn-success me-2 text-white" data-backdrop="static" data-keyboard="false">Approve</button>
                                <button id="btnModalReject" type="button" class="btn btn-danger me-2 text-white" data-backdrop="static" data-keyboard="false">Reject</button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!--Modal Popup-->
    <div class="modal fade" id="approveModal" tabindex="-1" aria-labelledby="exampleModalLabel" style="display: none;" aria-hidden="true">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">

                <div class="modal-body ">
                    <div class="content p-0">
                        <button type="button" class="btn-close close_btn" data-bs-dismiss="modal" aria-label="Close"></button>
                        <img src="~/assets/images/thumbs-up.png" class="icon_reject ">
                        <p class="message-type text-blod  pt-3">
                            Are you sure you want to approve the application ?
                        </p>
                        <div class="col-sm-12 mb-3 px-0">
                            <label class="form-label d-block mb-1">Remark<span class="text-danger req_text">*</span></label>
                            <textarea id="txtRemark" class="form-control form-control-sm" placeholder="Remark"></textarea>
                        </div>

                    </div>
                    <div class="text-center">
                        <button type="button" class="btn btn-brand popUp_btn me-2" data-backdrop="static" data-keyboard="false" id="btnApprove">Yes, Approve</button>
                        <button type="button" class="btn btn-danger popUp_btn me-2" data-bs-dismiss="modal">Close</button>

                    </div>
                </div>
            </div>

        </div>
    </div>

    <div class="modal fade" id="rejectModal" tabindex="-1" aria-labelledby="exampleModalLabel" style="display: none;" aria-hidden="true">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">

                <div class="modal-body ">
                    <div class="content p-0">
                        <button type="button" class="btn-close close_btn" data-bs-dismiss="modal" aria-label="Close"></button>
                        <img src="~/assets/images/thumbs-up.png" class="icon_reject ">
                        <p class="message-type text-blod  pt-3">
                            Are you sure you want to reject the application ?
                        </p>
                        <div class="col-sm-12 mb-3 px-0">
                            <label class="form-label d-block mb-1">Remark<span class="text-danger req_text">*</span></label>
                            <textarea id="txtRemark1" class="form-control form-control-sm" placeholder="Remark"></textarea>
                        </div>

                    </div>
                    <div class="text-center">
                        <button type="button" class="btn btn-brand popUp_btn me-2" data-backdrop="static" data-keyboard="false" id="btnReject">Yes, Reject</button>
                        <button type="button" class="btn btn-danger popUp_btn me-2" data-bs-dismiss="modal">Close</button>

                    </div>
                </div>
            </div>

        </div>
    </div>

</div>

@section CashlessCreditletter{
    @*<script type="text/javascript" src="~/js/Mediclaim/Processing/ApproveRejectCashlessCreditLette.js"></script>*@

        <script type="text/javascript">
            $(document).ready(function () {

                let Extended_Stay = ''; // Define variable correctly
                let DocumentsArray = [];


                $('#btnApprove').click(function () {
                    PopulateCashlessProperties();
                    var request = {
                        SerialNo: $('#hdnempno').val(),
                        StatusCreditId: 2,
                        RejectReason: null,
                        Remark: $('#txtRemark').val(),
                        CMORemark: $('#txtCMORemark').val(),
                        Designation: $('#hdndesignation').val(),
                        Extended_Stay: $('#txtexteded_date').val().trim() || '0',
                        //const extendedStayValue = document.getElementById('txtexteded_date').value.trim() || '0';
                        Documents: DocumentsArray,

                    }
                    $.ajax({
                        type: 'POST',
                        url: "/Mediclaim/Processing/Cashless/ApproveRejectCredit",
                        data: JSON.stringify(request),
                        contentType: 'application/json; charset=utf-8',
                        //dataType: 'json',
                        success: function (response, status, xhr) {

                            $('#approveModal').modal('hide');
                            if (xhr.status == '200') {
                                if (response == "Success") {

                                    setTimeout(function () {
                                        window.location.href = "/Mediclaim/Processing/CashlessCreditletter";
                                    }, 1000);
                                }
                                else {

                                }
                            }
                        },
                        error: function (xhr, status, error) {
                            $('#approveModal').modal('hide');
                        }
                    });

                });

                $('#btnReject').click(function () {

                    if ($('#txtRejectReason').val() !== '') {
                        $('#txtRejectReason').removeClass('is-invalid');
                        var request = {
                            SerialNo: $('#hdnempno').val(),
                            StatusCreditId: 3,
                            RejectReason: null,
                            ApprovedAmount: $('#txtApproveAmount').val(),
                            Remark: $('#txtRemark1').val(),
                            CMORemark: $('#txtCMORemark').val(),
                            Designation: $('#hdndesignation').val()
                        }

                        $.ajax({
                            type: 'POST',
                            url: "/Mediclaim/Processing/Cashless/ApproveRejectCredit",
                            data: JSON.stringify(request),
                            contentType: 'application/json; charset=utf-8',
                            //dataType: 'json',
                            success: function (response, status, xhr) {
                                $('#rejectModal').modal('hide');
                                if (xhr.status == '200') {
                                    if (response == "Success") {

                                        $('#txtRejectReason').val('');

                                        setTimeout(function () {
                                            window.location.href = "/Mediclaim/Processing/CashlessCreditletter";
                                        }, 1000);
                                    }
                                    else {

                                    }
                                }
                            },
                            error: function (xhr, status, error) {
                                $('#rejectModal').modal('hide');
                            }
                        });
                    }
                    else {
                        $('#txtRejectReason').addClass('is-invalid');
                    }
                });

                $('#btnModalApprove').click(function () {
                    $('#approveModal').modal('show');
                    //var ApprovedAmount = $('#txtApproveAmount').val();
                    //if (parseFloat(ApprovedAmount) > 0) {
                    //    //$('input[type="text"]').remove('is-invalid');
                    //    $('#approveModal').modal('show');
                    //}
                    //else {
                    //    //$('#validationModal').modal('show');
                    //    //$('input[type="text"]').addClass('is-invalid');
                    //}
                });

                $('#btnModalReject').click(function () {
                    $('#rejectModal').modal('show');
                });

                var PopulateCashlessProperties = function () {

                    //var DocumentsArray = [];
                    $("#tblDocument tbody tr").each(function () {
                        DocumentsArray.push(JSON.parse($(this).find('td input.hdndoc').val()));
                    });
                }

                $('#btnUpload').click(function () {

                    FileUpload_extended_date();
                });


                var FileUpload_extended_date = function () {

                    var srNo = 1;

                    var _indicator = $('#selDocumentType').val();
                    var form = new FormData();
                    var uploadfiles = $('#fileUpload')[0].files;

                    for (var i = 0; i != uploadfiles.length; i++) {
                        form.append("Files", uploadfiles[i]);
                    }

                    if (uploadfiles.length > 0) {
                        $.ajax({
                            type: 'POST',
                            url: '/Mediclaim/Raise/Upload_CaseSummary/Extend_Date/' + _indicator,
                            data: form,
                            contentType: 'application/json; charset=utf-8',
                            timeout: 0,
                            processData: false,
                            contentType: false,
                            success: function (response, status, xhr) {
                                $('#fileUpload').val('');
                                if (xhr.status == "200") {
                                    if ($('#tblDocument tbody tr').length >= 0)
                                        if (response.length > 0) {
                                            $.each(response, function (index, item) {
                                                var _hdnItem = JSON.stringify(item);
                                                var row = `<tr>
<td>
                                                            ${srNo}
<input type="hidden" class="hdndoc" value='${_hdnItem}'>
</td>
<td>${item.documentFor}</td>
<td>${item.fileName}</td>
<td><a href="#" onclick="DeleteFile('${item.documentPath}',this)" class="btn btn-danger btn-sm mr-2 btn_small"><i class="fa fa-trash" aria-hidden="true"></i></a></td></tr>`
                                                $('#tblDocument tbody').append(row);
                                            });
                                            srNo = srNo + 1;
                                        };
                                }
                            },
                            error: function (xhr, status, error) {

                            }
                        });
                    }
                    else {
                        alert('Please upload document')
                    }
                };

                function DeleteFile(currentfile, row) {
                    if (confirm("Are you sure you want to delete the user?")) {
                        $.ajax({
                            type: 'POST',
                            url: "/Mediclaim/Raise/DeleteFile/Cashless",
                            data: JSON.stringify(currentfile),
                            contentType: 'application/json; charset=utf-8',
                            //dataType: 'json',
                            success: function (response, status, xhr) {
                                if (xhr.status == '200') {
                                    $(row).parents("tr").remove();
                                }
                                else {
                                    alert(response);
                                }
                            },
                            error: function (xhr, status, error) {

                            }
                        });
                    }
                }
                document.getElementById('chk_Extended').addEventListener('change', function () {
                    const isVisible = this.checked;
                    document.getElementById('exedend_heder').style.display = isVisible ? 'block' : 'none';
                    document.getElementById('Extednded_duration').style.display = isVisible ? 'flex' : 'none';
                });
            });
        </script>
        <script src="~/js/numbertoword.js"></script>
        <script>
            $(document).ready(function () {
                var numberToWord = new NumberToWord();
                if ($('#txtApproveAmount').val() !== '0') {
                    $('#txtApproveAmountInWords').val(numberToWord.ToWord($('#txtApproveAmount').val()))
                }
                $('#txtApproveAmount').focusout(function () {
                    $('#txtApproveAmountInWords').val(numberToWord.ToWord($('#txtApproveAmount').val()))
                });

            });
        </script>
    }

    @*<script type="text/javascript">
                debugger;
                $(document).ready(function () {
                    debugger;
                    let Extended_Stay = ''; // Define variable correctly
                    let DocumentsArray = [];
                    $('#btnApprove').click(function () {
                        var request = {
                            SerialNo: $('#hdnempno').val(),
                            StatusCreditId: 2,
                            RejectReason: null,
                            Remark: $('#txtRemark').val(),
                            CMORemark: $('#txtCMORemark').val(),
                            Designation: $('#hdndesignation').val(),
                              Extended_Stay: $('#txtexteded_date').val().trim() || '0',
                            //const extendedStayValue = document.getElementById('txtexteded_date').value.trim() || '0';
                            Documents: DocumentsArray,
                        }
                        $.ajax({
                            type: 'POST',
                            url: "/Mediclaim/Processing/Cashless/ApproveRejectCredit",
                            data: JSON.stringify(request),
                            contentType: 'application/json; charset=utf-8',
                            //dataType: 'json',
                            success: function (response, status, xhr) {

                                $('#approveModal').modal('hide');
                                if (xhr.status == '200') {
                                    if (response == "Success") {

                                        setTimeout(function () {
                                            window.location.href = "/Mediclaim/Processing/CashlessCreditletter";
                                        }, 1000);
                                    }
                                    else {

                                    }
                                }
                            },
                            error: function (xhr, status, error) {
                                $('#approveModal').modal('hide');
                            }
                        });

                    });

                    $('#btnReject').click(function () {
                        debugger;
                        if ($('#txtRejectReason').val() !== '') {
                            $('#txtRejectReason').removeClass('is-invalid');
                            var request = {
                                EmployeeNo: $('#hdnempno').val(),
                                StatusCreditId: 3,
                                RejectReason: null,
                                ApprovedAmount: $('#txtApproveAmount').val(),
                                Remark: $('#txtRemark1').val(),
                                CMORemark: $('#txtCMORemark').val(),
                                Designation: $('#hdndesignation').val()
                            }

                            $.ajax({
                                type: 'POST',
                                url: "/Mediclaim/Processing/Cashless/ApproveRejectCredit",
                                data: JSON.stringify(request),
                                contentType: 'application/json; charset=utf-8',
                                //dataType: 'json',
                                success: function (response, status, xhr) {
                                    $('#rejectModal').modal('hide');
                                    if (xhr.status == '200') {
                                        if (response == "Success") {

                                            $('#txtRejectReason').val('');

                                            setTimeout(function () {
                                                window.location.href = "/Mediclaim/Processing/CashlessCreditletter";
                                            }, 1000);
                                        }
                                        else {

                                        }
                                    }
                                },
                                error: function (xhr, status, error) {
                                    $('#rejectModal').modal('hide');
                                }
                            });
                        }
                        else {
                            $('#txtRejectReason').addClass('is-invalid');
                        }
                    });

                    $('#btnModalApprove').click(function () {
                        $('#approveModal').modal('show');
                        //var ApprovedAmount = $('#txtApproveAmount').val();
                        //if (parseFloat(ApprovedAmount) > 0) {
                        //    //$('input[type="text"]').remove('is-invalid');
                        //    $('#approveModal').modal('show');
                        //}
                        //else {
                        //    //$('#validationModal').modal('show');
                        //    //$('input[type="text"]').addClass('is-invalid');
                        //}
                    });

                    $('#btnModalReject').click(function () {
                        $('#rejectModal').modal('show');
                    });
                    var PopulateCashlessProperties = function () {
                        debugger;
                        //var DocumentsArray = [];
                        $("#tblDocument tbody tr").each(function () {
                            DocumentsArray.push(JSON.parse($(this).find('td input.hdndoc').val()));
                        });
                    }

                    $('#btnUpload').click(function () {
                        debugger;
                        FileUpload_extended_date();
                    });


                    var FileUpload_extended_date = function () {
                        debugger;
                        var srNo = 1;

                        var _indicator = $('#selDocumentType').val();
                        var form = new FormData();
                        var uploadfiles = $('#fileUpload')[0].files;

                        for (var i = 0; i != uploadfiles.length; i++) {
                            form.append("Files", uploadfiles[i]);
                        }

                        if (uploadfiles.length > 0) {
                            $.ajax({
                                type: 'POST',
                                url: '/Mediclaim/Raise/Upload_CaseSummary/Extend_Date/' + _indicator,
                                data: form,
                                contentType: 'application/json; charset=utf-8',
                                timeout: 0,
                                processData: false,
                                contentType: false,
                                success: function (response, status, xhr) {
                                    $('#fileUpload').val('');
                                    if (xhr.status == "200") {
                                        debugger;
                                        if ($('#tblDocument tbody tr').length >= 0)
                                            if (response.length > 0) {
                                                $.each(response, function (index, item) {
                                                    var _hdnItem = JSON.stringify(item);
                                                    var row = `<tr>
                                                    <td>
                                                        ${srNo}
                                                        <input type="hidden" class="hdndoc" value='${_hdnItem}'>
                                                    </td>
                                                    <td>${item.documentFor}</td>
                                                    <td>${item.fileName}</td>
                                                    <td><a href="#" onclick="DeleteFile('${item.documentPath}',this)" class="btn btn-danger btn-sm mr-2 btn_small"><i class="fa fa-trash" aria-hidden="true"></i></a></td></tr>`
                                                    $('#tblDocument tbody').append(row);
                                                });
                                                srNo = srNo + 1;
                                            };
                                    }
                                },
                                error: function (xhr, status, error) {

                                }
                            });
                        }
                        else {
                            alert('Please upload document')
                        }
                    };

                    function DeleteFile(currentfile, row) {
                        if (confirm("Are you sure you want to delete the user?")) {
                            $.ajax({
                                type: 'POST',
                                url: "/Mediclaim/Raise/DeleteFile/Cashless",
                                data: JSON.stringify(currentfile),
                                contentType: 'application/json; charset=utf-8',
                                //dataType: 'json',
                                success: function (response, status, xhr) {
                                    if (xhr.status == '200') {
                                        $(row).parents("tr").remove();
                                    }
                                    else {
                                        alert(response);
                                    }
                                },
                                error: function (xhr, status, error) {

                                }
                            });
                        }
                    }


                    document.getElementById('chk_Extended').addEventListener('change', function () {
                        const isVisible = this.checked;

                        document.getElementById('exedend_heder').style.display = isVisible ? 'block' : 'none';


                        document.getElementById('Extednded_duration').style.display = isVisible ? 'flex' : 'none';
                    });
                });
            </script>
            <script src="~/js/numbertoword.js"></script>
            <script>
                $(document).ready(function () {
                    var numberToWord = new NumberToWord();
                    if ($('#txtApproveAmount').val() !== '0') {
                        $('#txtApproveAmountInWords').val(numberToWord.ToWord($('#txtApproveAmount').val()))
                    }

                    $('#txtApproveAmount').focusout(function () {
                        $('#txtApproveAmountInWords').val(numberToWord.ToWord($('#txtApproveAmount').val()))
                    });

                });
            </script>
        }*@

    <!--@section NonCashlessClaimsView{-->
    <!--<script src="~/assets/js/tab.js"></script>
        <script type="text/javascript">
            $(document).ready(function () {
                debugger;
                $('#btnApprove').click(function () {
                    var request = {
                        //ClaimId: $('#hdnClaimId').val(),
                        ClaimStatusId: 2,
                        RejectReason: null,
                        ApprovedAmount: $('#txtApproveAmount').val(),
                        Remark: $('#txtRemark').val(),
                        CMORemark: $('#txtCMORemark').val(),
                        Designation: $('#hdndesignation').val()
                    }
                    $.ajax({
                        type: 'POST',
                        url: "/Mediclaim/Processing/Cashless/ApproveReject",
                        data: JSON.stringify(request),
                        contentType: 'application/json; charset=utf-8',
                        //dataType: 'json',
                        success: function (response, status, xhr) {

                            $('#approveModal').modal('hide');
                            if (xhr.status == '200') {
                                if (response == "Success") {

                                    //$('#approvemsg').modal('show');
                                    //let message = `Claim ${$('#hdnClaimId').val()} is approved successfully`
                                    //$('#lblApproveMessage').text(message);

                                    setTimeout(function () {
                                        window.location.href = "/Mediclaim/IPD/ProcessingList";
                                    }, 2000);
                                }
                                else {
                                    //$('#approvemsg').modal('show');
                                    //let message = `Something went wrong`;
                                    //$('#lblReturnMessage').text(message);


                                }
                            }
                        },
                        error: function (xhr, status, error) {
                            $('#approveModal').modal('hide');
                        }
                    });

                });

                $('#btnReject').click(function () {
                    if ($('#txtRejectReason').val() !== '') {
                        $('#txtRejectReason').removeClass('is-invalid');
                        var request = {
                            ClaimId: $('#hdnClaimId').val(),
                            ClaimStatusId: 3,
                            RejectReason: $('#txtRejectReason').val(),
                            ApprovedAmount: 0,
                            CMORemark: $('#txtCMORemark').val(),
                            //DealingAssistanceRemark: $('#txtDealingAssistantRemark').val(),
                            //ASORemark: $('#txtASORemark').val(),
                            //SORemark: $('#txtSORemark').val(),
                            Designation: $('#hdndesignation').val()
                        }

                        $.ajax({
                            type: 'POST',
                            url: "/Mediclaim/Processing/Cashless/ApproveReject",
                            data: JSON.stringify(request),
                            contentType: 'application/json; charset=utf-8',
                            //dataType: 'json',
                            success: function (response, status, xhr) {
                                $('#rejectModal').modal('hide');
                                if (xhr.status == '200') {
                                    if (response == "Success") {

                                        //$('#rejectmsg').modal('show');
                                        //let message = `Claim ${$('#hdnClaimId').val()} is rejected `;
                                        //$('#lblRejectMessage').text(message);
                                        $('#txtRejectReason').val('');

                                        setTimeout(function () {
                                            window.location.href = "/Mediclaim/IPD/ProcessingList";
                                        }, 2000);
                                    }
                                    else {
                                        //$('#rejectmsg').modal('show');
                                        //let message = `Something went wrong`;
                                        //$('#lblRejectMessage').text(message);

                                    }
                                }
                            },
                            error: function (xhr, status, error) {
                                $('#rejectModal').modal('hide');
                            }
                        });
                    }
                    else {
                        $('#txtRejectReason').addClass('is-invalid');
                    }
                });

                $('#btnModalApprove').click(function () {
                    var ApprovedAmount = $('#txtApproveAmount').val();
                    if (parseFloat(ApprovedAmount) > 0) {
                        //$('input[type="text"]').remove('is-invalid');
                        $('#approveModal').modal('show');
                    }
                    else {
                        //$('#validationModal').modal('show');
                        //$('input[type="text"]').addClass('is-invalid');
                    }
                });

                $('#btnModalReject').click(function () {
                    $('#rejectModal').modal('show');
                });
            });
        </script>
        <script src="~/js/numbertoword.js"></script>
        <script>
            $(document).ready(function () {
                var numberToWord = new NumberToWord();
                if ($('#txtApproveAmount').val() !== '0') {
                    $('#txtApproveAmountInWords').val(numberToWord.ToWord($('#txtApproveAmount').val()))
                }

                $('#txtApproveAmount').focusout(function () {
                    $('#txtApproveAmountInWords').val(numberToWord.ToWord($('#txtApproveAmount').val()))
                });

            });
        </script>
    }-->
